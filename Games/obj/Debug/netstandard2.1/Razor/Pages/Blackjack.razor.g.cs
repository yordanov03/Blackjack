#pragma checksum "C:\Blackjack\BlazorGames\Pages\Blackjack.razor" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "b6c6ee111bf7d6c2fc6937515037a59867f4b6a3"
// <auto-generated/>
#pragma warning disable 1591
namespace Games.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "C:\Blackjack\BlazorGames\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "C:\Blackjack\BlazorGames\_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Blackjack\BlazorGames\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Blackjack\BlazorGames\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Blackjack\BlazorGames\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Blackjack\BlazorGames\_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Blackjack\BlazorGames\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Blackjack\BlazorGames\_Imports.razor"
using Games;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Blackjack\BlazorGames\_Imports.razor"
using Games.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
using Games.Models.Blackjack;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
using Games.Models.Blackjack.Enums;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
using Games.Pages.Partials;

#line default
#line hidden
#nullable disable
    [Microsoft.AspNetCore.Components.RouteAttribute("/blackjack")]
    public partial class Blackjack : Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
            __builder.OpenComponent<Games.Shared.PageTitle>(0);
            __builder.AddAttribute(1, "Title", "Blackjack");
            __builder.CloseComponent();
            __builder.AddMarkupContent(2, "\n\n\n");
            __builder.OpenElement(3, "div");
            __builder.AddAttribute(4, "class", "row");
            __builder.AddMarkupContent(5, "\n    ");
            __builder.OpenElement(6, "div");
            __builder.AddAttribute(7, "class", "col-3");
            __builder.AddMarkupContent(8, "\n        ");
            __builder.OpenElement(9, "div");
            __builder.AddMarkupContent(10, "\n");
#nullable restore
#line 212 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
              
                int cardCount = dealer.Deck.Count + 1;
            

#line default
#line hidden
#nullable disable
#nullable restore
#line 215 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
             while (cardCount > 0)
            {

#line default
#line hidden
#nullable disable
            __builder.AddContent(11, "                ");
            __builder.AddMarkupContent(12, "<div class=\"blackjack-drawdeck\">\n                    <img src=\"images/blackjack/cardBack.png\">\n                </div>\n");
#nullable restore
#line 220 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                cardCount -= 13;
            }

#line default
#line hidden
#nullable disable
            __builder.AddContent(13, "        ");
            __builder.CloseElement();
            __builder.AddMarkupContent(14, "\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(15, "\n    ");
            __builder.OpenElement(16, "div");
            __builder.AddAttribute(17, "class", "col-3");
            __builder.AddMarkupContent(18, "\n        ");
            __builder.OpenComponent<Games.Pages.Partials.BlackjackHand>(19);
            __builder.AddAttribute(20, "Cards", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Collections.Generic.List<Games.Models.Blackjack.Card>>(
#nullable restore
#line 225 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                              dealer.Cards

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(21, "\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(22, "\n    ");
            __builder.OpenElement(23, "div");
            __builder.AddAttribute(24, "class", "col-3");
            __builder.AddMarkupContent(25, "\n        ");
            __builder.OpenComponent<Games.Pages.Partials.BlackjackScore>(26);
            __builder.AddAttribute(27, "State", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Games.Models.Blackjack.Enums.GameState>(
#nullable restore
#line 228 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                               state

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(28, "Player", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Games.Models.Blackjack.Person>(
#nullable restore
#line 228 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                              dealer

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(29, "\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(30, "\n");
            __builder.CloseElement();
            __builder.AddMarkupContent(31, "\n");
            __builder.OpenElement(32, "div");
            __builder.AddAttribute(33, "class", "row");
            __builder.AddMarkupContent(34, "\n    ");
            __builder.OpenElement(35, "div");
            __builder.AddAttribute(36, "class", "col-3");
            __builder.AddMarkupContent(37, "\n        ");
            __builder.OpenComponent<Games.Pages.Partials.BlackjackFunds>(38);
            __builder.AddAttribute(39, "Funds", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Decimal>(
#nullable restore
#line 233 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                               player.Funds

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(40, "Change", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Decimal>(
#nullable restore
#line 233 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                     player.Change

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(41, "\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(42, "\n    ");
            __builder.OpenElement(43, "div");
            __builder.AddAttribute(44, "class", "col-3");
            __builder.AddMarkupContent(45, "\n");
#nullable restore
#line 236 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
         if (state == GameState.Betting)
        {
            

#line default
#line hidden
#nullable disable
#nullable restore
#line 238 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
             if (player.Funds < 10)
            {

#line default
#line hidden
#nullable disable
            __builder.AddContent(46, "                ");
            __builder.AddMarkupContent(47, "<span class=\"display-3 text-danger\">Out of money!</span>\n");
#nullable restore
#line 241 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
            }

#line default
#line hidden
#nullable disable
#nullable restore
#line 242 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
             if (player.Funds >= 10)
            {

#line default
#line hidden
#nullable disable
            __builder.AddContent(48, "                ");
            __builder.OpenElement(49, "button");
            __builder.AddAttribute(50, "class", "btn btn-primary");
            __builder.AddAttribute(51, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 244 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                          (() => Bet(10))

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(52, "Bet $10");
            __builder.CloseElement();
            __builder.AddMarkupContent(53, "\n");
#nullable restore
#line 245 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
            }

#line default
#line hidden
#nullable disable
#nullable restore
#line 246 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
             if (player.Funds >= 20)
            {

#line default
#line hidden
#nullable disable
            __builder.AddContent(54, "                ");
            __builder.OpenElement(55, "button");
            __builder.AddAttribute(56, "class", "btn btn-primary");
            __builder.AddAttribute(57, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 248 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                          (() => Bet(20))

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(58, "Bet $20");
            __builder.CloseElement();
            __builder.AddMarkupContent(59, "\n");
#nullable restore
#line 249 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
            }

#line default
#line hidden
#nullable disable
#nullable restore
#line 250 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
             if (player.Funds >= 50)
            {

#line default
#line hidden
#nullable disable
            __builder.AddContent(60, "                ");
            __builder.OpenElement(61, "button");
            __builder.AddAttribute(62, "class", "btn btn-primary");
            __builder.AddAttribute(63, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 252 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                          (() => Bet(50))

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(64, "Bet $50");
            __builder.CloseElement();
            __builder.AddMarkupContent(65, "\n");
#nullable restore
#line 253 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
            }

#line default
#line hidden
#nullable disable
#nullable restore
#line 253 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
             
        }

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(66, "\n");
#nullable restore
#line 256 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
         if (state == GameState.Payout)
        {

#line default
#line hidden
#nullable disable
            __builder.AddContent(67, "            ");
            __builder.OpenComponent<Games.Pages.Partials.BlackjackHandResult>(68);
            __builder.AddAttribute(69, "Player", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Games.Models.Blackjack.Person>(
#nullable restore
#line 258 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                         player

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(70, "Dealer", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Games.Models.Blackjack.Person>(
#nullable restore
#line 258 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                         dealer

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(71, "\n");
#nullable restore
#line 259 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
        }

#line default
#line hidden
#nullable disable
#nullable restore
#line 260 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
         if(state == GameState.Dealing || state == GameState.Shuffling
         || state == GameState.InProgress || state == GameState.EscortedOut)
        {

#line default
#line hidden
#nullable disable
            __builder.AddContent(72, "            ");
            __builder.OpenComponent<Games.Pages.Partials.BlackjackMessage>(73);
            __builder.AddAttribute(74, "State", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Games.Models.Blackjack.Enums.GameState>(
#nullable restore
#line 263 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                     state

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(75, "Bet", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Decimal>(
#nullable restore
#line 263 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                 player.Bet

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(76, "\n");
#nullable restore
#line 264 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
        }

#line default
#line hidden
#nullable disable
            __builder.AddContent(77, "    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(78, "\n");
            __builder.CloseElement();
            __builder.AddMarkupContent(79, "\n\n");
            __builder.OpenElement(80, "div");
            __builder.AddAttribute(81, "class", "row");
            __builder.AddMarkupContent(82, "\n    ");
            __builder.OpenElement(83, "div");
            __builder.AddAttribute(84, "class", "col-3");
            __builder.AddMarkupContent(85, "\n");
#nullable restore
#line 270 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
         if (state == GameState.NotStarted || state == GameState.EscortedOut || player.Funds < 10)
        {

#line default
#line hidden
#nullable disable
            __builder.AddContent(86, "            ");
            __builder.OpenElement(87, "button");
            __builder.AddAttribute(88, "class", "btn btn-secondary");
            __builder.AddAttribute(89, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 272 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                        (() => InitializeHand())

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(90, "Start Game");
            __builder.CloseElement();
            __builder.AddMarkupContent(91, "\n");
#nullable restore
#line 273 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
        }

#line default
#line hidden
#nullable disable
#nullable restore
#line 274 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
         if (!player.IsBusted && state == GameState.InProgress && !player.HasStood)
        {

#line default
#line hidden
#nullable disable
            __builder.AddContent(92, "            ");
            __builder.OpenElement(93, "button");
            __builder.AddAttribute(94, "class", "btn btn-primary");
            __builder.AddAttribute(95, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 276 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                      (() => Stand())

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(96, "Stand");
            __builder.CloseElement();
            __builder.AddMarkupContent(97, "\n            ");
            __builder.OpenElement(98, "button");
            __builder.AddAttribute(99, "class", "btn btn-primary");
            __builder.AddAttribute(100, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 277 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                      (() => Hit())

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(101, "Hit");
            __builder.CloseElement();
            __builder.AddMarkupContent(102, "\n");
#nullable restore
#line 278 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
             if (player.Score >= 9
               && player.Score <= 11
               && player.Cards.Count == 2
               && player.Funds >= player.Bet * 2)
            {

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(103, "                <br>\n                ");
            __builder.OpenElement(104, "button");
            __builder.AddAttribute(105, "class", "btn btn-warning");
            __builder.AddAttribute(106, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 284 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                          (() => DoubleDown())

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(107, "Double Down");
            __builder.CloseElement();
            __builder.AddMarkupContent(108, "\n");
#nullable restore
#line 285 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
            }

#line default
#line hidden
#nullable disable
#nullable restore
#line 286 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
             if (dealer.HasAceShowing && !player.HasInsurance)
            {

#line default
#line hidden
#nullable disable
            __builder.AddMarkupContent(109, "                <br>\n                ");
            __builder.OpenElement(110, "button");
            __builder.AddAttribute(111, "class", "btn btn-warning");
            __builder.AddAttribute(112, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 289 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                          (() => Insurance())

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(113, "Insurance ($");
            __builder.AddContent(114, 
#nullable restore
#line 289 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                                                             player.Bet / 2

#line default
#line hidden
#nullable disable
            );
            __builder.AddContent(115, ")");
            __builder.CloseElement();
            __builder.AddMarkupContent(116, "\n");
#nullable restore
#line 290 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
            }

#line default
#line hidden
#nullable disable
#nullable restore
#line 290 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
             
        }

#line default
#line hidden
#nullable disable
#nullable restore
#line 292 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
         if (state == GameState.Payout)
        {

#line default
#line hidden
#nullable disable
            __builder.AddContent(117, "            ");
            __builder.OpenElement(118, "button");
            __builder.AddAttribute(119, "class", "btn btn-secondary");
            __builder.AddAttribute(120, "onclick", Microsoft.AspNetCore.Components.EventCallback.Factory.Create<Microsoft.AspNetCore.Components.Web.MouseEventArgs>(this, 
#nullable restore
#line 294 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                                        (() => NewHand())

#line default
#line hidden
#nullable disable
            ));
            __builder.AddContent(121, "Keep Going!");
            __builder.CloseElement();
            __builder.AddMarkupContent(122, "\n");
#nullable restore
#line 295 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
        }

#line default
#line hidden
#nullable disable
            __builder.AddContent(123, "    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(124, "\n    ");
            __builder.OpenElement(125, "div");
            __builder.AddAttribute(126, "class", "col-3");
            __builder.AddMarkupContent(127, "\n        ");
            __builder.OpenComponent<Games.Pages.Partials.BlackjackHand>(128);
            __builder.AddAttribute(129, "Cards", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<System.Collections.Generic.List<Games.Models.Blackjack.Card>>(
#nullable restore
#line 298 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                              player.Cards

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(130, "\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(131, "\n    ");
            __builder.OpenElement(132, "div");
            __builder.AddAttribute(133, "class", "col-3");
            __builder.AddMarkupContent(134, "\n        ");
            __builder.OpenComponent<Games.Pages.Partials.BlackjackScore>(135);
            __builder.AddAttribute(136, "State", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Games.Models.Blackjack.Enums.GameState>(
#nullable restore
#line 301 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                               state

#line default
#line hidden
#nullable disable
            ));
            __builder.AddAttribute(137, "Player", Microsoft.AspNetCore.Components.CompilerServices.RuntimeHelpers.TypeCheck<Games.Models.Blackjack.Person>(
#nullable restore
#line 301 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
                                              player

#line default
#line hidden
#nullable disable
            ));
            __builder.CloseComponent();
            __builder.AddMarkupContent(138, "\n    ");
            __builder.CloseElement();
            __builder.AddMarkupContent(139, "\n");
            __builder.CloseElement();
            __builder.AddMarkupContent(140, "\n\n");
            __builder.OpenComponent<Games.Pages.Partials.BlackjackRules>(141);
            __builder.CloseComponent();
        }
        #pragma warning restore 1998
#nullable restore
#line 9 "C:\Blackjack\BlazorGames\Pages\Blackjack.razor"
       
    Dealer dealer = new Dealer(); //Creating a new Dealer also creates a new, shuffled CardDeck
    Player player = new Player();

    GameState state = GameState.NotStarted;

    public async Task InitializeHand()
    {
        if (dealer.Deck.Count < 13)
        {
            state = GameState.Shuffling;
            dealer.Deck = new CardDeck();
            await Delay(1000);
        }

        state = GameState.Betting;
    }

    public async Task Bet(decimal amount)
    {
        if (player.Funds >= amount)
        {
            player.Bet += amount;
            await Deal();
        }
    }

    public async Task Deal()
    {
        state = GameState.Dealing;
        //Deal a card to each player. The dealer's card is not visible.
        await dealer.DealToPlayer(player);
        StateHasChanged();

        var dealerCard = dealer.Deal();
        dealerCard.IsVisible = false;
        await dealer.AddCard(dealerCard);
        StateHasChanged();

        //Deal another card to each player and the dealer; these will all be visible.
        await dealer.DealToPlayer(player);
        StateHasChanged();

        await dealer.DealToSelf();
        StateHasChanged();

        state = GameState.InProgress;

        //If the player has a natural blackjack, the hand is over.
        if (player.HasNaturalBlackjack)
        {
            EndHand();
        }
    }

    public async Task NewHand()
    {
        //Payout the player's bets
        player.Collect();

        //Clear the hands
        player.ClearHand();
        dealer.ClearHand();

        //Reset the game area
        state = GameState.NotStarted;

        //Easter egg!
        if(player.Funds > 1000)
        {
            state = GameState.EscortedOut;
            return;
        }

        //Begin a new hand!
        await InitializeHand();
    }

    public async Task Delay(int millis)
    {
        await Task.Delay(millis);
        StateHasChanged();
    }

    public async Task DealerTurn()
    {
        if(dealer.Score < 17)
        {
            await dealer.DealToSelf();
            StateHasChanged();
            await DealerTurn();
        }
    }

    public async Task Hit()
    {
        await dealer.DealToPlayer(player);
        if(player.IsBusted)
        {
            EndHand();
        }
    }

    public async Task Stand()
    {
        player.HasStood = true;
        dealer.Reveal();

        await DealerTurn();

        EndHand();
    }

    public void EndHand()
    {
        state = GameState.Payout;
        if (player.HasNaturalBlackjack && dealer.Score != 21)
        {
            //Player gets their bet back, plus 1.5 * the bet
            player.Change += player.Bet * 1.5M;
        }
        else if (!player.IsBusted && dealer.IsBusted)
        {
            //If the player is not busted but the dealer is, the player gets the amount of their bet back, plus the bet again.
            player.Change += player.Bet;
        }
        else if (!dealer.IsBusted && !player.IsBusted && player.Score > dealer.Score)
        {
            //This is a "normal" win condition; the player has more than the dealer and neither are busted.
            player.Change += player.Bet;
        }
        else if (!dealer.IsBusted && !player.IsBusted && player.Score == dealer.Score)
        {
            //If there's a push, no money changes hands
        }
        else //In all other situations, the player loses their bet.
        {
            player.Change += player.Bet * -1;
        }

        //No matter what, the player's bet gets reset
        player.Bet = 0;
        player.HasStood = false;
    }

    public async Task DoubleDown()
    {
        player.HasStood = true;
        //The player may only do this if their shown score is 9, 10, or 11.
        //If this happens, the player doubles their bet.
        player.Bet *= 2;

        await Delay(300);

        //The player then gets one additional card
        await player.AddCard(dealer.Deal());

        //At this point, the player is forced to stand.
        await Stand();
    }

    //If the dealer has an Ace showing, the player may choose to make an insurance bet.
    //If the player chooses to make an insurance bet, they place a separate bet of 1/2 the original bet
    //The dealer then looks at the hidden card.
    //If the hidden card is a ten card, the dealer pays back the player at 2-to-1.
    //Otherwise, the player loses the insurance bet, and play continues as normal
    public void Insurance()
    {
        state = GameState.Insurance;

        if(dealer.HasAceShowing)
        {
            //Insurance bet is half the original bet
            player.InsuranceBet = player.Bet / 2;

            if(dealer.Score == 21) //If the dealer has Blackjack
            {
                //Reveal the hidden card
                dealer.Reveal();

                //Pay the player twice the insurance bet
                player.Change += player.InsuranceBet * 2;

                //Go straight to the Payout state
                state = GameState.Payout;
                StateHasChanged();
                EndHand();
            }
            else
            {
                //Player loses their insurance bet
                player.Change -= player.InsuranceBet;
            }
        }

        //Unless the hand is over, play continues normally.
        state = GameState.InProgress;
    }

#line default
#line hidden
#nullable disable
    }
}
#pragma warning restore 1591
